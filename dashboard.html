<script>
  const firebaseConfig = {
    apiKey: "AIzaSyB6_l2tZUDgs_SktXC0mhEuHgBLEZvENBM",
    authDomain: "lorrytracker-rr.firebaseapp.com",
    databaseURL: "https://lorrytracker-rr-default-rtdb.asia-southeast1.firebasedatabase.app/",
    projectId: "lorrytracker-rr",
    storageBucket: "lorrytracker-rr.appspot.com",
    messagingSenderId: "721117238968",
    appId: "1:721117238968:web:35028a5fa52ac7dfa1064d"
  };

  firebase.initializeApp(firebaseConfig);
  const db = firebase.database();

  const map = L.map('map').setView([0, 0], 2); // Start zoomed out

  L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    attribution: 'Map data Â© <a href="https://openstreetmap.org">OpenStreetMap</a> contributors'
  }).addTo(map);

  const marker = L.marker([0, 0]).addTo(map);

  // Poll the Firebase database every 30 seconds
  setInterval(() => {
    db.ref('driver/location').once('value', (snapshot) => {
      const data = snapshot.val();
      if (data) {
        const { latitude, longitude } = data;
        marker.setLatLng([latitude, longitude]);
        map.setView([latitude, longitude], 15);
      }
    });
  }, 30000);  // 30 seconds interval

</script>
